<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Infer infection events dates from delayed observations — deconvolve_incidence • estimateR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Infer infection events dates from delayed observations — deconvolve_incidence" />
<meta property="og:description" content="This function reconstructs an incidence of infection events
from incidence data representing delayed observations.
The assumption made is that delayed observations represent
the convolution of the time series of infections with a delay distribution.
deconvolve_incidence implements a deconvolution algorithm (Richardson-Lucy) to reconstruct
a vector of infection events from input data that represents delayed observations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimateR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/estimateR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/comparison_levels_input_details.html">Estimating Re using more or less detailed data</a>
    </li>
    <li>
      <a href="../articles/incidence_data_workflow_example.html">From aggregated incidence data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/linelist_workflow_example.html">From raw linelist data to Re estimates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Infer infection events dates from delayed observations</h1>
    
    <div class="hidden name"><code>deconvolve_incidence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reconstructs an incidence of infection events
from incidence data representing delayed observations.
The assumption made is that delayed observations represent
the convolution of the time series of infections with a delay distribution.
<code>deconvolve_incidence</code> implements a deconvolution algorithm (Richardson-Lucy) to reconstruct
a vector of infection events from input data that represents delayed observations.</p>
    </div>

    <pre class="usage"><span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  <span class='va'>incidence_data</span>,
  deconvolution_method <span class='op'>=</span> <span class='st'>"Richardson-Lucy delay distribution"</span>,
  <span class='va'>delay</span>,
  simplify_output <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>incidence_data</th>
      <td><p>An object containing incidence data through time.
It can either be:</p><ul>
<li><p>A list with two elements:</p><ol>
<li><p>A numeric vector named <code>values</code>: the incidence recorded on consecutive time steps.</p></li>
<li><p>An integer named <code>index_offset</code>: the offset, counted in number of time steps,
by which the first value in <code>values</code> is shifted compared to a reference time step
This parameter allows one to keep track of the date of the first value in <code>values</code>
without needing to carry a <code>date</code> column around.
A positive offset means <code>values</code> are delayed in the future compared to the reference values.
A negative offset means the opposite.</p></li>
</ol></li>
<li><p>A numeric vector. The vector corresponds to the <code>values</code> element
descrived above, and <code>index_offset</code> is implicitely zero.
This means that the first value in <code>incidence_data</code>
is associated with the reference time step (no shift towards the future or past).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>deconvolution_method</th>
      <td><p>string. Method used to infer timings of infection
events from the original incidence data (aka deconvolution step).
Available options are:</p><ul>
<li><p>'Richardson-Lucy delay distribution',
implemented in <code><a href='.deconvolve_incidence_Richardson_Lucy.html'>.deconvolve_incidence_Richardson_Lucy</a></code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>delay</th>
      <td><p>Single delay or list of delays.
Each delay can be one of:</p><ul>
<li><p>a list representing a distribution object</p></li>
<li><p>a discretized delay distribution vector</p></li>
<li><p>a discretized delay distribution matrix</p></li>
<li><p>a dataframe containing empirical delay data</p></li>
</ul></td>
    </tr>
    <tr>
      <th>simplify_output</th>
      <td><p>boolean. Return a numeric vector instead of module
output object if output offset is zero?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='convolve_delays.html'>convolve_delays</a></code>, <code><a href='.deconvolve_incidence_Richardson_Lucy.html'>.deconvolve_incidence_Richardson_Lucy</a></code></p><dl>
    <dt><code>n_report_time_steps</code></dt><dd><p>integer. Length of incidence time series.
Use only when providing empirical delay data.</p></dd>
    <dt><code>delays</code></dt><dd><p>List of delays, with flexible structure.
Each delay in the <code>delays</code> list can be one of:
<ul>
<li><p>a list representing a distribution object</p></li>
<li><p>a discretized delay distribution vector</p></li>
<li><p>a discretized delay distribution matrix</p></li>
<li><p>a dataframe containing empirical delay data</p></li>
</ul></p></dd>
    <dt><code>delay_distribution</code></dt><dd><p>numeric square matrix or vector.</p></dd>
    <dt><code>threshold_chi_squared</code></dt><dd><p>numeric scalar. Threshold for chi-squared values under which the R-L algorithm stops.</p></dd>
    <dt><code>max_iterations</code></dt><dd><p>integer. Maximum threshold for the number of iterations in the R-L algorithm.</p></dd>
    <dt><code>verbose</code></dt><dd><p>Boolean. Print verbose output?</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with two elements:</p><ol>
<li><p>A numeric vector named <code>values</code>: the result of the computations on the input data.</p></li>
<li><p>An integer named <code>index_offset</code>: the offset, counted in number of time steps,
by which the result is shifted compared to an <code>index_offset</code> of <code>0</code>.
This parameter allows one to keep track of the date of the first value in <code>values</code>
without needing to carry a <code>date</code> column around.
A positive offset means <code>values</code> are delayed in the future compared to the reference values.
A negative offset means the opposite.
Note that the <code>index_offset</code> of the output of the function call
accounts for the (optional) <code>index_offset</code> of the input.</p></li>
</ol><p>If <code>index_offset</code> is <code>0</code> and <code>simplify_output = TRUE</code>,
the <code>index_offset</code> is dropped and the <code>values</code>
element is returned as a numeric vector.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>smoothed_onset_incidence</span> <span class='op'>&lt;-</span> <span class='fu'><a href='smooth_incidence.html'>smooth_incidence</a></span><span class='op'>(</span><span class='va'>HK_incidence_data</span><span class='op'>$</span><span class='va'>onset_incidence</span><span class='op'>)</span>
<span class='va'>smoothed_case_incidence</span> <span class='op'>&lt;-</span> <span class='fu'><a href='smooth_incidence.html'>smooth_incidence</a></span><span class='op'>(</span><span class='va'>HK_incidence_data</span><span class='op'>$</span><span class='va'>case_incidence</span><span class='op'>)</span>

<span class='co'>## Deconvolving symptom onset data.</span>
<span class='co'># In case the data to be deconvolved represents noisy observations of symptom</span>
<span class='co'># onset, only the delay distribution of the incubation time needs to be specified</span>
<span class='co'># (time that passes between case incidence and showing of symptoms).</span>

<span class='va'>shape_incubation</span> <span class='op'>=</span> <span class='fl'>3.2</span>
<span class='va'>scale_incubation</span> <span class='op'>=</span> <span class='fl'>1.3</span>
<span class='va'>delay_incubation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"gamma"</span>, shape <span class='op'>=</span> <span class='va'>shape_incubation</span>, scale <span class='op'>=</span> <span class='va'>scale_incubation</span><span class='op'>)</span>

<span class='va'>deconvolved_incidence_1</span> <span class='op'>&lt;-</span> <span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  incidence_data <span class='op'>=</span> <span class='va'>smoothed_onset_incidence</span>,
  delay <span class='op'>=</span> <span class='va'>delay_incubation</span>
<span class='op'>)</span>


<span class='co'>## Deconvolving report incidence data.</span>
<span class='co'># In case the data to be deconvolved represents noisy observations of case reports,</span>
<span class='co'># both the delay distribution of the incubation time and the delay distribution</span>
<span class='co'># of the time that passes between symptom onset and the case being reported.</span>

<span class='va'>shape_onset_to_report</span> <span class='op'>=</span> <span class='fl'>2.7</span>
<span class='va'>scale_onset_to_report</span> <span class='op'>=</span> <span class='fl'>1.6</span>
<span class='va'>delay_onset_to_report</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"gamma"</span>,
                              shape <span class='op'>=</span> <span class='va'>shape_onset_to_report</span>,
                              scale <span class='op'>=</span> <span class='va'>scale_onset_to_report</span><span class='op'>)</span>

<span class='va'>deconvolved_incidence_2</span> <span class='op'>&lt;-</span> <span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  incidence_data <span class='op'>=</span> <span class='va'>smoothed_case_incidence</span>,
  delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>delay_incubation</span>, <span class='va'>delay_onset_to_report</span><span class='op'>)</span>
<span class='op'>)</span>


<span class='co'>## Other available formats for specifying delay distributions</span>

<span class='co'># Discretized delay distribution vector</span>
<span class='va'>mean_incubation</span> <span class='op'>=</span> <span class='fl'>5.2</span>
<span class='va'>std_incubation</span> <span class='op'>=</span> <span class='fl'>1.6</span>
<span class='va'>delay_distribution_incubation</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>name<span class='op'>=</span><span class='st'>"norm"</span>,
                                      mean <span class='op'>=</span> <span class='va'>mean_incubation</span>,
                                      sd <span class='op'>=</span> <span class='va'>std_incubation</span><span class='op'>)</span>
<span class='va'>delay_incubation_vector</span> <span class='op'>&lt;-</span> <span class='fu'><a href='build_delay_distribution.html'>build_delay_distribution</a></span><span class='op'>(</span><span class='va'>delay_distribution_incubation</span><span class='op'>)</span>

<span class='va'>deconvolved_incidence_3</span> <span class='op'>&lt;-</span> <span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  incidence_data <span class='op'>=</span> <span class='va'>smoothed_onset_incidence</span>,
  delay <span class='op'>=</span> <span class='va'>delay_incubation_vector</span>
<span class='op'>)</span>

<span class='co'># Discretized delay distribution matrix</span>
<span class='va'>delay_distribution_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_matrix_from_empirical_delay_distr.html'>get_matrix_from_empirical_delay_distr</a></span><span class='op'>(</span>
  <span class='va'>HK_delay_data</span>,
  n_report_time_steps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>smoothed_case_incidence</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>deconvolved_incidence_4</span> <span class='op'>&lt;-</span> <span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  incidence_data <span class='op'>=</span> <span class='va'>smoothed_case_incidence</span>,
  delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>delay_incubation</span>, <span class='va'>delay_distribution_matrix</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Dataframe containing empirical delay data</span>
<span class='va'>deconvolved_incidence_5</span> <span class='op'>&lt;-</span> <span class='fu'>deconvolve_incidence</span><span class='op'>(</span>
  incidence_data <span class='op'>=</span> <span class='va'>smoothed_case_incidence</span>,
  delay <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>delay_incubation</span>, <span class='va'>HK_delay_data</span><span class='op'>)</span>
<span class='op'>)</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jérémie Scire, Ana Grosu, Daniel Angst, Jana Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


