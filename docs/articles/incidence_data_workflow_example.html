<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>From aggregated incidence data to Re estimates • estimateR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="From aggregated incidence data to Re estimates">
<meta property="og:description" content="estimateR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimateR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/estimateR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adding_methods.html">Adding a new method to the package</a>
    </li>
    <li>
      <a href="../articles/comparison_levels_input_details.html">Estimating Re using more or less detailed data</a>
    </li>
    <li>
      <a href="../articles/incidence_data_workflow_example.html">From aggregated incidence data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/linelist_workflow_example.html">From raw linelist data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/simulating_data.html">Simulating data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="incidence_data_workflow_example_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>From aggregated incidence data to Re estimates</h1>
            
      
      
      <div class="hidden name"><code>incidence_data_workflow_example.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we demonstrate a workflow for estimating Re from aggregated incidence data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">estimateR</span><span class="op">)</span>

<span class="co"># Data handling packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'lubridate'</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     date, intersect, setdiff, union</span>

<span class="co"># Package for plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>In this example, we fetch and analyze COVID-19 incidence data from Estonia. The Estonian public health authorities publish detailed COVID-19 related data <a href="https://www.terviseamet.ee/et/koroonaviirus/avaandmed">here</a>. We start by fetching the dataset containing the number of reported cases for each day since the beginning of the COVID-19 pandemic.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://opendata.digilugu.ee/opendata_covid19_tests_total.csv"</span>
<span class="va">EST_data</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   LastStatisticsDate = col_date(format = ""),</span>
<span class="co">#&gt;   StatisticsDate = col_date(format = ""),</span>
<span class="co">#&gt;   DailyCases = col_double(),</span>
<span class="co">#&gt;   TotalCases = col_double(),</span>
<span class="co">#&gt;   TotalCasesLast14D = col_double(),</span>
<span class="co">#&gt;   PerPopulation = col_double()</span>
<span class="co">#&gt; )</span>

<span class="kw">if</span> <span class="op">(</span><span class="st">"try-error"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">EST_data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Couldn't read EST case data at "</span>, <span class="va">url</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  
<span class="co"># Keep columns of interest only  </span>
<span class="va">EST_incidence</span> <span class="op">&lt;-</span> <span class="va">EST_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span><span class="op">(</span><span class="va">StatisticsDate</span><span class="op">)</span>,
            case_incidence <span class="op">=</span> <span class="va">DailyCases</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In case the data is inaccessible, an earlier version is stored in the <code>EST_incidence_data</code> variable with <strong>estimateR</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">EST_incidence</span> <span class="op">&lt;-</span> <span class="va">EST_incidence_data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">EST_incidence</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 2</span>
<span class="co">#&gt;   date       case_incidence</span>
<span class="co">#&gt;   &lt;date&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2020-02-26              1</span>
<span class="co">#&gt; 2 2020-02-27              0</span>
<span class="co">#&gt; 3 2020-02-28              0</span>
<span class="co">#&gt; 4 2020-02-29              0</span>
<span class="co">#&gt; 5 2020-03-01              0</span>
<span class="co">#&gt; 6 2020-03-02              1</span></code></pre></div>
<p>As a curation step, we make sure that there is no missing date and no negative or NA values in the original data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">EST_incidence</span> <span class="op">&lt;-</span> <span class="va">EST_incidence</span> <span class="op">%&gt;%</span> 
  <span class="co"># replace potential negative values by 0</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>case_incidence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">case_incidence</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">case_incidence</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">#replace potential NA values by 0</span>
   <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>case_incidence <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># add zeroes for dates with no reported case</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,
                                      by <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span>,
                  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>case_incidence <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now that our incidence data is ready and curated, we need to gather all COVID-19 parameters required for the Re estimation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Delay between infection and onset of symptoms (incubation period) in days</span>
<span class="co"># Ref: Linton et al., Journal of Clinical Medicine, 2020</span>
<span class="co"># Gamma distribution parameter</span>
<span class="va">shape_incubation</span> <span class="op">&lt;-</span> <span class="fl">3.2</span>
<span class="va">scale_incubation</span> <span class="op">&lt;-</span> <span class="fl">1.3</span>

<span class="co"># Incubation period delay distribution</span>
<span class="va">distribution_incubation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"gamma"</span>, 
                                shape <span class="op">=</span> <span class="va">shape_incubation</span>, 
                                scale <span class="op">=</span> <span class="va">scale_incubation</span><span class="op">)</span>


<span class="co">## Delay between onset of symptoms and case confirmation in days</span>
<span class="co"># Ref: Bi et al., The Lancet Infectious Diseases, 2020</span>
<span class="co"># Gamma distribution parameter</span>
<span class="va">shape_onset_to_confirmation</span> <span class="op">&lt;-</span> <span class="fl">2.1</span>
<span class="va">scale_onset_to_confirmation</span> <span class="op">&lt;-</span> <span class="fl">2.6</span>

<span class="co"># Incubation period delay distribution</span>
<span class="va">distribution_onset_to_confirmation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"gamma"</span>, 
                                shape <span class="op">=</span> <span class="va">shape_onset_to_confirmation</span>, 
                                scale <span class="op">=</span> <span class="va">scale_onset_to_confirmation</span><span class="op">)</span>

<span class="co">## Serial interval (for Re estimation) in days</span>
<span class="co"># Ref: Nishiura et al.,International Journal of Infectious Diseases, 2020</span>
<span class="va">mean_serial_interval</span> <span class="op">&lt;-</span> <span class="fl">4.8</span>
<span class="va">std_serial_interval</span> <span class="op">&lt;-</span> <span class="fl">2.3</span></code></pre></div>
<p>We also need some specifications for the analysis:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">estimation_window</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># 3-day sliding window for the Re estimation</span>
<span class="va">minimum_cumul_incidence</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># we start estimating Re after at least 100 cases have been recorded</span>
<span class="va">N_bootstrap_replicates</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># we take 100 replicates in the bootstrapping procedure</span>

<span class="co"># We specifiy the reference date (first date of data) and the time step of data.</span>
<span class="va">ref_date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">EST_incidence</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>
<span class="va">time_step</span> <span class="op">=</span> <span class="st">"day"</span></code></pre></div>
<p>We can then perform the Re estimation. The computations will take a few seconds to complete.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">EST_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_block_bootstrapped_estimate.html">get_block_bootstrapped_estimate</a></span><span class="op">(</span>
  incidence_data <span class="op">=</span> <span class="va">EST_incidence</span><span class="op">$</span><span class="va">case_incidence</span>,
  N_bootstrap_replicates <span class="op">=</span> <span class="va">N_bootstrap_replicates</span>,
  delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">distribution_incubation</span>, <span class="va">distribution_onset_to_confirmation</span><span class="op">)</span>,
  estimation_window <span class="op">=</span> <span class="va">estimation_window</span>,
  minimum_cumul_incidence <span class="op">=</span> <span class="va">minimum_cumul_incidence</span>,
  mean_serial_interval <span class="op">=</span> <span class="va">mean_serial_interval</span>,
  std_serial_interval <span class="op">=</span> <span class="va">std_serial_interval</span>,
  ref_date <span class="op">=</span> <span class="va">ref_date</span>,
  time_step <span class="op">=</span> <span class="va">time_step</span>,
  combine_bootstrap_and_estimation_uncertainties <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">EST_estimates</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 4</span>
<span class="co">#&gt;   date       Re_estimate CI_down_Re_estimate CI_up_Re_estimate</span>
<span class="co">#&gt;   &lt;date&gt;           &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2020-03-06        2.14                1.63              2.66</span>
<span class="co">#&gt; 2 2020-03-07        1.87                1.44              2.31</span>
<span class="co">#&gt; 3 2020-03-08        1.65                1.29              2.01</span>
<span class="co">#&gt; 4 2020-03-09        1.49                1.18              1.80</span>
<span class="co">#&gt; 5 2020-03-10        1.38                1.11              1.66</span>
<span class="co">#&gt; 6 2020-03-11        1.31                1.06              1.58</span></code></pre></div>
<p>Now let us plot these estimates through time, along with their confidence intervals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">EST_estimates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">Re_estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>lwd<span class="op">=</span>  <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, ymax <span class="op">=</span> <span class="va">CI_up_Re_estimate</span>, ymin <span class="op">=</span> <span class="va">CI_down_Re_estimate</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.45</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>,
               date_labels <span class="op">=</span> <span class="st">'%b\n%Y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Reproductive number"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="incidence_data_workflow_example_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>The results seem reasonable overall, especially from November 2020 on. However, the two wide swings in June and July 2020 are suspicious. Let us zoom in on the raw incidence data to check if the data seems to carry real signal for these swings or if they are byproducts of isolated bumps in the reported numbers.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">EST_incidence</span>, <span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-09-01"</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-05-01"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">case_incidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>,
               date_labels <span class="op">=</span> <span class="st">'%b\n%Y'</span><span class="op">)</span></code></pre></div>
<p><img src="incidence_data_workflow_example_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>For both early June and early July we see that the overall numbers are very low, and that the Re peaks correspond to particularly high outliers in the reported numbers. Moreover, uncertainty intervals are very wide during this period.</p>
<p>This should make us wary of drawing any conclusions for the Re estimates over this period before investigating whether the peaks in the observed numbers were not explainable by something else than a rise in Re. The external reason could be an adjustment in the reported numbers, or a one-time large testing event.</p>
<p>It is always extremely valuable to plot the incidence data when doing an Re estimation, even when nothing looks suspicious in the estimates.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jérémie Scire, Ana Grosu, Daniel Angst, Jana Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
