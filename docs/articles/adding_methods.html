<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding a new method to the package • estimateR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding a new method to the package">
<meta property="og:description" content="estimateR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">estimateR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/estimateR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adding_methods.html">Adding a new method to the package</a>
    </li>
    <li>
      <a href="../articles/comparison_levels_input_details.html">Estimating Re using more or less detailed data</a>
    </li>
    <li>
      <a href="../articles/incidence_data_workflow_example.html">From aggregated incidence data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/linelist_workflow_example.html">From raw linelist data to Re estimates</a>
    </li>
    <li>
      <a href="../articles/simulating_data.html">Simulating data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="adding_methods_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adding a new method to the package</h1>
            
      
      
      <div class="hidden name"><code>adding_methods.Rmd</code></div>

    </div>

    
    
<p>This vignette aims to explain the steps required in order to extend the functionality of the package. It is not targeted towards the regular user but towards either: method developers that wish to contribute to the estimateR package, or users with good programming knowledge who find that a certain function needed in their analysis is missing. The estimateR package is built in such a way that extending existing functionality is as easy as possible. A standard analysis might include the following steps: smoothing the data, performing a deconvolution step to recover the infection time-series and finally performing an estimation step to recover the reproductive number. Each one of these steps is implemented separately from the others, as an independent module. The top-level functions usually take a string argument that specifies the method to be used when performing the respective action. For example, the smoothing function <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> can apply different smoothing methods, by passing different strings to the <code>smoothing_method</code> parameter. This makes adding new functionality easy, by adding a new accepted value for the <code>..._method</code> parameter, that implements the desired behaviour.</p>
<p>In this vignette, we will add an exponential smoothing method to the <code>smooth_incidence</code> function. Exponential smoothing is a form of smoothing that computes a weighted average over all observations in the input time series, with weights that are exponentially decreasing over time, depending on a constant smoothing parameter. It acts as a low-pass filters, removing high-frequency noise. The <code>smooth</code> package provides an exponential smoothing function, <code>es()</code>. Thus, we will create a wrapper around the <code><a href="https://rdrr.io/pkg/smooth/man/es.html">smooth::es()</a></code> function, and include it in estimateR, by adding <code>smoothing_method = "EXPONENTIAL"</code> as an accepted parameter value.</p>
<p>The functions that accept this type of extensions are:</p>
<ul>
<li>
<code>smooth_incidence</code>, by implementing an additional <code>smoothing_method</code>
</li>
<li>
<code>deconvolve_incidence</code>, by implementing an additional <code>deconvolution_method</code>
</li>
<li>
<code>estimate_Re</code>, by implementing an additional <code>estimation_method</code>
</li>
<li>
<code>get_bootstrap_replicate</code>, by implementing an additional <code>bootstrapping_method</code>
</li>
<li>
<code>summarise_uncertainty</code>, by implementing an additional <code>uncertainty_summary_method</code>
</li>
</ul>
<div id="adding-a-new-smoothing-method" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-a-new-smoothing-method" class="anchor"></a>Adding a new smoothing method</h2>
<p>Adding a new function to the package requires having access to the latest version of the source code, which can be obtained by cloning the GitHub repository from <a href="https://github.com/covid-19-Re/estimateR">here</a>.</p>
<p>The first step is to navigate to the source code of the function for which we want to add functionality. In this case, since we want to add a new parameter value for the <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function, we will navigate to the “R\smooth.R” file. In this file, the LOESS smoothing method is already implemented, in <code><a href="../reference/.smooth_LOESS.html">.smooth_LOESS()</a></code>. Following the same structure, we will create a new function called <code>.smooth_EXP()</code>.</p>
<p>The first step is to write the <code>.smooth_EXP()</code> function itself. Looking at the already implemented <code><a href="../reference/.smooth_LOESS.html">.smooth_LOESS()</a></code> function, we see that the data type of <code>incidence_input</code> is “module input”. We also note that our smoothing function should return a “module output” type variable. The “module input” and “module output” variables can be either strictly positive numerical vectors or lists with two elements: <code>values</code> (strictly positive numerical vector) and <code>index_offset</code> (integer). The <code>index_offset</code> represents the offset, counted in number of time steps, by which the first value in <code>values</code> is shifted compared to a reference time step. A more detailed explanation can be found in the documentation about <code>module inputs</code>. The incidence values can be recovered from a “module input” variable using the <code><a href="../reference/.get_values.html">.get_values()</a></code> function. “module output” variables can be constructed using the <code><a href="../reference/.get_module_output.html">.get_module_output()</a></code> function. Our new <code>.smooth_EXP()</code> function will then have the structure below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.smooth_EXP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">incidence_input</span>, <span class="va">...additional_parameters</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">incidence_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_values.html">.get_values</a></span><span class="op">(</span><span class="va">incidence_input</span><span class="op">)</span>
  
  <span class="co">### exponential smoothing of incidence values contained by incidence_vector</span>
  <span class="va">...</span>
  <span class="va">...</span>
  <span class="va">smoothed_vector</span> <span class="op">&lt;-</span> <span class="fu">...function</span><span class="op">(</span><span class="va">incidence_vector</span><span class="op">)</span>
  <span class="co">###</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="../reference/.get_module_output.html">.get_module_output</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/smooth/man/es.html">smooth::es()</a></code> function accepts many optional parameters, out of which we choose to only include some (<code>initial</code>, <code>level</code> and <code>cumulative</code>), for the sole purpose of exemplifying adding functions with different parameter data types (changing any of these parameters does not affect the smoothing of the data passed as input, which is the part we use; it only affects the forecasting of these values into the future). We will also make sure that all the inferred infection numbers are positive numbers. We will do this by replacing any negative number with 0.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">smoothed_vector</span> <span class="op">&lt;-</span> <span class="fu">smooth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smooth/man/es.html">es</a></span><span class="op">(</span><span class="va">incidence_vector</span>, 
                                initial<span class="op">=</span><span class="va">initial</span>, 
                                level<span class="op">=</span> <span class="va">level</span>,
                                cumulative<span class="op">=</span><span class="va">cumulative</span><span class="op">)</span><span class="op">$</span><span class="va">fitted</span>
  <span class="va">smoothed_vector</span><span class="op">[</span><span class="va">smoothed_vector</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<p>In order to use the <code><a href="../reference/.get_module_output.html">.get_module_output()</a></code> function, however, we need to convert the output of <code><a href="https://rdrr.io/pkg/smooth/man/es.html">smooth::es()</a></code> to a vector. We also need to pass on whatever offset the initial data might have had onto the output. Our function’s return will look like below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">...</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="../reference/.get_module_output.html">.get_module_output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_vector</span><span class="op">)</span>, <span class="fu"><a href="../reference/.get_offset.html">.get_offset</a></span><span class="op">(</span><span class="va">incidence_input</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>We need to check the values of the parameters, to ensure the user has passed the expected data types. This can be done using the <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code> function, that receives as parameter a list of lists that contain the parameter to be tested and the expected data type of the parameter. Details about how to validate the parameters, construct the <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code> call, as well as adding a new parameter data type for the <code>initial</code> parameter can be found below, in the <a href="#validating-parameter-values">Validating parameter values</a> section. The validation call will look like below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">incidence_input</span>, <span class="st">"module_input"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"exponential_smoothing_initial"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">level</span>, <span class="st">"number"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cumulative</span>, <span class="st">"boolean"</span><span class="op">)</span>
    <span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Putting together all the chunks above, the final <code>smooth_EXP()</code> function will look like so.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.smooth_EXP</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">incidence_input</span>, <span class="va">initial</span><span class="op">=</span><span class="st">"optimal"</span>, <span class="va">level</span> <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">cumulative</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">incidence_input</span>, <span class="st">"module_input"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"exponential_smoothing_initial"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">level</span>, <span class="st">"number"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cumulative</span>, <span class="st">"boolean"</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>
  
  <span class="va">incidence_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_values.html">.get_values</a></span><span class="op">(</span><span class="va">incidence_input</span><span class="op">)</span>
  <span class="va">smoothed_vector</span> <span class="op">&lt;-</span> <span class="fu">smooth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/smooth/man/es.html">es</a></span><span class="op">(</span><span class="va">incidence_vector</span>, 
                                initial<span class="op">=</span><span class="va">initial</span>, 
                                level<span class="op">=</span> <span class="va">level</span>,
                                cumulative<span class="op">=</span><span class="va">cumulative</span><span class="op">)</span><span class="op">$</span><span class="va">fitted</span>
  <span class="va">smoothed_vector</span><span class="op">[</span><span class="va">smoothed_vector</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="../reference/.get_module_output.html">.get_module_output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">smoothed_vector</span><span class="op">)</span>, <span class="fu"><a href="../reference/.get_offset.html">.get_offset</a></span><span class="op">(</span><span class="va">incidence_input</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span></code></pre></div>
<p>The second step is to add the new “exponential smoothing” method as an accepted method for the <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function. In <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code>, there are a series of <code>if ... else</code> statements that call the appropriate smoothing function for a given method. The <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function currently looks like so:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smooth_incidence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">incidence_data</span>,
                             <span class="va">smoothing_method</span> <span class="op">=</span> <span class="st">"LOESS"</span>,
                             <span class="va">simplify_output</span> <span class="op">=</span> <span class="cn">TRUE</span>,
                             <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">incidence_data</span>, <span class="st">"module_input"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">smoothing_method</span>, <span class="st">"smoothing_method"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">simplify_output</span>, <span class="st">"boolean"</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>


  <span class="va">dots_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_dots_as_list.html">.get_dots_as_list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_module_input.html">.get_module_input</a></span><span class="op">(</span><span class="va">incidence_data</span><span class="op">)</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"LOESS"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
      <span class="st">".smooth_LOESS"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>incidence_input <span class="op">=</span> <span class="va">input</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/.get_shared_args.html">.get_shared_args</a></span><span class="op">(</span><span class="va">.smooth_LOESS</span>, <span class="va">dots_args</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="va">input</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.make_empty_module_output.html">.make_empty_module_output</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">simplify_output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.simplify_output.html">.simplify_output</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We want that, in the case the user inputs <code>smoothing_method = "EXPONENTIAL"</code> as a parameter to the <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function, the <code>.smooth_EXP()</code> smoothing method defined above is called. In order to implement this, we will add a new <code>if()...else</code> loop.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smooth_incidence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">incidence_data</span>,
                             <span class="va">smoothing_method</span> <span class="op">=</span> <span class="st">"LOESS"</span>,
                             <span class="va">simplify_output</span> <span class="op">=</span> <span class="cn">TRUE</span>,
                             <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">incidence_data</span>, <span class="st">"module_input"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">smoothing_method</span>, <span class="st">"smoothing_method"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">simplify_output</span>, <span class="st">"boolean"</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>


  <span class="va">dots_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_dots_as_list.html">.get_dots_as_list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_module_input.html">.get_module_input</a></span><span class="op">(</span><span class="va">incidence_data</span><span class="op">)</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"LOESS"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
      <span class="st">".smooth_LOESS"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>incidence_input <span class="op">=</span> <span class="va">input</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/.get_shared_args.html">.get_shared_args</a></span><span class="op">(</span><span class="va">.smooth_LOESS</span>, <span class="va">dots_args</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
    
  <span class="co">### Added changes start</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"EXPONENTIAL"</span><span class="op">)</span><span class="op">{</span>
    <span class="co">###</span>
    <span class="co">### ... call the newly implemented smoothing function ...</span>
    <span class="co">###</span>
  <span class="co">### Added changes end</span>
    
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="va">input</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.make_empty_module_output.html">.make_empty_module_output</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">simplify_output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.simplify_output.html">.simplify_output</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Following the structure of the <code>if()</code> statement corresponding to the LOESS smoothing, we will use <code><a href="https://rdrr.io/r/base/do.call.html">do.call()</a></code> to call our new smoothing method. We will pass as arguments to the <code>.smooth_EXP()</code> function the <code>incidence_data</code> on which the smoothing needs to be performed, as well as any additional parameters that were passed in the dot arguments of <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code>, that <code>.smooth_EXP()</code> knows how to interpret. This list of parameters can be retrieved by using the already implemented <code><a href="../reference/.get_shared_args.html">.get_shared_args()</a></code> function. In our case, for example, this will pass on the <code>initial</code>, <code>level</code> and <code>cumulative</code> parameters, if specified by the user. After making these changes, the <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function will look like below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smooth_incidence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">incidence_data</span>,
                             <span class="va">smoothing_method</span> <span class="op">=</span> <span class="st">"LOESS"</span>,
                             <span class="va">simplify_output</span> <span class="op">=</span> <span class="cn">TRUE</span>,
                             <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">incidence_data</span>, <span class="st">"module_input"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">smoothing_method</span>, <span class="st">"smoothing_method"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">simplify_output</span>, <span class="st">"boolean"</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>


  <span class="va">dots_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_dots_as_list.html">.get_dots_as_list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.get_module_input.html">.get_module_input</a></span><span class="op">(</span><span class="va">incidence_data</span><span class="op">)</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"LOESS"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
      <span class="st">".smooth_LOESS"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>incidence_input <span class="op">=</span> <span class="va">input</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/.get_shared_args.html">.get_shared_args</a></span><span class="op">(</span><span class="va">.smooth_LOESS</span>, <span class="va">dots_args</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
    
  <span class="co">### Added changes start</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"EXPONENTIAL"</span><span class="op">)</span><span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
      <span class="st">".smooth_EXP"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>incidence_input <span class="op">=</span> <span class="va">input</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/.get_shared_args.html">.get_shared_args</a></span><span class="op">(</span><span class="va">.smooth_EXP</span>, <span class="va">dots_args</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="co">### Added changes end</span>
    
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">smoothing_method</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="va">input</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.make_empty_module_output.html">.make_empty_module_output</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">simplify_output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">smoothed_incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/.simplify_output.html">.simplify_output</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
  <span class="op">}</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">smoothed_incidence</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In order for the “EXPONENTIAL” string to be an accepted value for the <code>smoothing_method</code> parameter, we need to add it to the list of accepted strings defined in the <code>R\\utils_validation.R</code> file. At the top of the file, in the <code>accepted_parameter_value</code> list, we will add “EXPONENTIAL” to the vector corresponding to <code>smoothing_method</code>. The <code>accepted_parameter_value</code> list, after modification, will look like so:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">accepted_parameter_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  smoothing_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LOESS"</span>, <span class="st">"EXPONENTIAL"</span>, <span class="st">"none"</span><span class="op">)</span>,
  deconvolution_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Richardson-Lucy delay distribution"</span>, <span class="st">"none"</span><span class="op">)</span>,
  estimation_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EpiEstim sliding window"</span>, <span class="st">"EpiEstim piecewise constant"</span><span class="op">)</span>,
  bootstrapping_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"non-parametric block boostrap"</span>, <span class="st">"none"</span><span class="op">)</span>,
  function_prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"p"</span>, <span class="st">"r"</span><span class="op">)</span>,
  uncertainty_summary_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"original estimate - CI from bootstrap estimates"</span>, 
                                 <span class="st">"bagged mean - CI from bootstrap estimates"</span><span class="op">)</span>,
  fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gamma"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="validating-parameter-values" class="section level2">
<h2 class="hasAnchor">
<a href="#validating-parameter-values" class="anchor"></a>Validating parameter values</h2>
<p>Validating parameters is an important step of adding novel functionality to the estimateR package, especially if the intention is to publish the changes for everyone to use, which we strongly encourage. It is not a mandatory step, as it can be skipped without affecting the final results. However it is advised to perform parameter value validation as it provides informative messages in case of errors and helps check the right data-types are passed on to the functions.</p>
<p>In order to ensure that all the parameter values passed by the user have the expected data types, at the beginning of every function in the estimateR package, a call to the <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code> function is made. The function takes as parameter a list of lists containing the name of the parameter to be tested, a string that defines its type and optionally, an aditional parameter needed for validation. An example such list is shown below. The list of all already implemented data types checks can be found at the bottom of the <code>R\\utils_validation.R</code> file, in the <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">.are_valid_argument_values</span>(<span class="fu">list</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(incidence_data, <span class="st">"module_input"</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(N_bootstrap_replicates, <span class="st">"non_negative_number"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(smoothing_method, <span class="st">"smoothing_method"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(delay, <span class="st">"delay_single_or_list"</span>, <span class="fu">.get_input_length</span>(incidence_data)) </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note: to check if an object is a delay object, for example, the length of</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the input data is needed. This is passed as a third element in the list</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># corresponding to the delay object</span></span></code></pre></div>
<p>The <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code> function will go through every parameter passed in the list, and call its corresponding validation function specified in the <code>switch</code> structure inside <code><a href="../reference/.are_valid_argument_values.html">.are_valid_argument_values()</a></code>. The validation functions already implemented take as parameters the value of the parameter to be validated (stored in <code>user_input</code>) and the original name the respective parameter had (in order to display informative error messages; stored in <code>parameter_name</code>). Depending on the case, some of them also make use of a third parameter, that (in case it was added as a third element to the list described above) is stored in <code>additional_function_parameter</code>. They all return <code>True</code> in case of success and, more importantly, <strong>they are assumed to throw an informative error, using the <code><a href="https://rdrr.io/r/base/stop.html">stop()</a></code> function, if the parameter does not satisfy the desired conditions</strong>. Other already implemented validation functions can be used in the new validation function as well. For example, if we wanted to add a new type, we would follow the following steps:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add validation function in R\utils_validation.R</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>.check_is_favourite_food <span class="ot">&lt;-</span> <span class="cf">function</span>(user_input, parameter_name) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">.check_if_null_or_belongs_to_class</span>(user_input, <span class="st">"character"</span>, parameter_name)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensures user_input is a string</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(user_input <span class="sc">!=</span> <span class="st">"chocolate"</span>){</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste0</span>(<span class="st">"Expected parameter "</span>, parameter_name, <span class="st">" to be `chocolate`."</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new line to the `switch` statement inside `.are_valid_argument_values()`, in R\utils_validation.R</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#...</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"favourite_food"</span> <span class="ot">=</span> <span class="fu">.check_is_favourite_food</span>(user_input, parameter_name),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#...</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the newly added parameter type for input validation in functions</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="cf">function</span>(food) {</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">.are_valid_argument_values</span>(<span class="fu">list</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(food, <span class="st">"favourite_food"</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  </span></code></pre></div>
<p>In the example described in <a href="#adding-a-new-smoothing-method">Adding a new smoothing method</a>, where we added a new smoothing method to the <code><a href="../reference/smooth_incidence.html">smooth_incidence()</a></code> function, the new function we implemented has four parameters that need validation: <code>incidence_input</code>,<code>level</code>, <code>cumulative</code> and <code>initial</code>. Suitable testing functions are already implemented for the first three. <code>initial</code> can have one of two values: {“optimal”, “backcasting”}. To check for this we can use the already implemented <code><a href="../reference/.is_value_in_accepted_values_vector.html">.is_value_in_accepted_values_vector()</a></code> function, like so:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the values `initial` can have to the accepted_parameter_value list, at the top of the </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># `R\\utils_validation.R` file </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>accepted_parameter_value <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial =</span> <span class="fu">c</span>(<span class="st">"optimal"</span>, <span class="st">"backcasting"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">smoothing_method =</span> <span class="fu">c</span>(<span class="st">"LOESS"</span>, <span class="st">"EXPONENTIAL"</span>, <span class="st">"none"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">deconvolution_method =</span> <span class="fu">c</span>(<span class="st">"Richardson-Lucy delay distribution"</span>, <span class="st">"none"</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimation_method =</span> <span class="fu">c</span>(<span class="st">"EpiEstim sliding window"</span>, <span class="st">"EpiEstim piecewise constant"</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrapping_method =</span> <span class="fu">c</span>(<span class="st">"non-parametric block boostrap"</span>, <span class="st">"none"</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">function_prefix =</span> <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"p"</span>, <span class="st">"r"</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">uncertainty_summary_method =</span> <span class="fu">c</span>(<span class="st">"original estimate - CI from bootstrap estimates"</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"bagged mean - CI from bootstrap estimates"</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"gamma"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new line to the `switch` statement inside `.are_valid_argument_values()`, in R\utils_validation.R</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#...</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"exponential_smoothing_initial"</span> <span class="ot">=</span> <span class="fu">.is_value_in_accepted_values_vector</span>(user_input, parameter_name),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#...</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a certain parameter is a valid `initial` parameter, in the new function we added</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  foo <span class="ot">&lt;-</span> <span class="cf">function</span>(initial_passed_by_user) {</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">.are_valid_argument_values</span>(<span class="fu">list</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(initial_passed_by_user, <span class="st">"exponential_smoothing_initial"</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... </span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  </span></code></pre></div>
</div>
<div id="last-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#last-steps" class="anchor"></a>Last steps</h2>
<div id="testing-and-loading-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#testing-and-loading-changes" class="anchor"></a>Testing and loading changes</h3>
<p>In order to load the changes, while in the estimateR folder, run:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>In order to check no errors were introduced by the new functionality, while in the estimateR folder, use:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/test.html">test</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="adding-unitary-tests-optional" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-unitary-tests-optional" class="anchor"></a>Adding unitary tests (optional)</h3>
<p>If you wish to publish the changes, for everybody to use, we strongly encourage adding at least one unit test to check the functionality of the newly added functions. The tests are implemented in the “tests\testthat\” folder, using the <a href="https://testthat.r-lib.org/"><code>testthat</code> package</a>. After adding the tests, load and test the changes again as described above.</p>
</div>
<div id="publishing-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#publishing-changes" class="anchor"></a>Publishing changes</h3>
<p>In order to include the changes in a new version of the package, clone the <a href="https://github.com/covid-19-Re/estimateR">GitHub repository</a> and create a new branch. Add the changes to this new branch and create a pull request. Make sure the functions are well documented. Ideally, examples may be added to the file corresponding to the edited function, in the “man\examples” folder.</p>
<p>We strongly encourage adding new functionality to the package, and we would be more than happy to provide our help with the process, if needed.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jérémie Scire, Ana Grosu, Daniel Angst, Jana Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
