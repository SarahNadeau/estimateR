<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reproductive number estimation from delayed infection reports â€¢ estimateR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Reproductive number estimation from delayed infection reports">
<meta property="og:description" content="Draft description. 
    The estimateR package implements a modular pipeline to estimate the effective reproductive number from incidence data.
    The incidence data does not need to directly represent infections.
    Instead, the incidence data can represent indirect and temporally-delayed noisy observations of infection events.
    Typically, these could be: case confirmation via testing for the pathogen of interest,
    or hospital admissions of patients suffering from the disease of interest,
    ICU admissions of such patients, or even deaths.
    In addition to incidence data, one needs an estimate of the delay distribution between infection events and their observations.
    Typically, the delay between an infection and its observation can be split into two independent delays:
    the incubation period and the delay between symptom onset and observation.
    If the incidence data represents dates of onset of symptoms, the latter delay is not needed.
    Once the original incidence data is transformed into incidence of infection events,
    the effective reproductive number is estimated using wrappers around the EpiEstim package (Cori et al. 2013).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">estimateR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/estimateR.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/comparison_levels_input_details.html">Estimating Re using more or less detailed data</a>
    </li>
    <li>
      <a href="articles/linelist_workflow_example.html">From raw linelist data to Re estimates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="readme" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#readme" class="anchor"></a>README</h1></div>
</div>
<div id="estimater-package" class="section level1">
<h1 class="hasAnchor">
<a href="#estimater-package" class="anchor"></a><em>estimateR</em> package</h1>
<p>The <em>estimateR</em> package provides tools to estimate the effective reproductive number through time from delayed and indirect observations of infection events. This package is under development. The README file is still at a super rough stage.</p>
<div id="quick-toy-example" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-toy-example" class="anchor"></a>Quick toy example</h2>
<p>We demonstrate below a basic use of the <em>estimateR</em> package. Check out the estimateR vignette for more details.</p>
<p>We start with arbitrary incidence data representing daily counts of case confirmations for a disease of interest. This incidence data counts the number of people getting tested positive for a particular infectious disease X on day <em>T</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">estimateR</span><span class="op">)</span>
<span class="va">date_first_data_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-02-24"</span><span class="op">)</span>
<span class="va">toy_incidence_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">9</span>,<span class="fl">19</span>,<span class="fl">14</span>,<span class="fl">36</span>,<span class="fl">16</span>,<span class="fl">39</span>,<span class="fl">27</span>,<span class="fl">46</span>,
                          <span class="fl">77</span>,<span class="fl">78</span>,<span class="fl">113</span>,<span class="fl">102</span>,<span class="fl">134</span>,<span class="fl">165</span>,<span class="fl">183</span>,
                          <span class="fl">219</span>,<span class="fl">247</span>,<span class="fl">266</span>,<span class="fl">308</span>,<span class="fl">304</span>,<span class="fl">324</span>,<span class="fl">346</span>,
                          <span class="fl">348</span>,<span class="fl">331</span>,<span class="fl">311</span>,<span class="fl">267</span>,<span class="fl">288</span>,<span class="fl">254</span>,<span class="fl">239</span><span class="op">)</span>


<span class="co">## The numbers below are part of the user input, </span>
<span class="co">## they need to be adapted to the particular disease studied.</span>

<span class="co"># Incubation period - gamma distribution parameters</span>
<span class="va">shape_incubation</span> <span class="op">=</span> <span class="fl">3.2</span> 
<span class="va">scale_incubation</span> <span class="op">=</span> <span class="fl">1.3</span>
<span class="va">incubation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"gamma"</span>, shape <span class="op">=</span> <span class="va">shape_incubation</span>, scale <span class="op">=</span> <span class="va">scale_incubation</span><span class="op">)</span>

<span class="co"># Delay from onset of symptoms to case observation - gamma distribution parameters</span>
<span class="va">shape_onset_to_report</span> <span class="op">=</span> <span class="fl">2.7</span>
<span class="va">scale_onset_to_report</span> <span class="op">=</span> <span class="fl">1.6</span>
<span class="va">onset_to_report</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"gamma"</span>, shape <span class="op">=</span> <span class="va">shape_onset_to_report</span>, scale <span class="op">=</span> <span class="va">scale_onset_to_report</span><span class="op">)</span>

<span class="co"># We specify these parameters in the same unit as the time steps in the original observation data.</span>
<span class="co"># For instance, if the original data represents daily reports,</span>
<span class="co"># the parameters below must be specified in days (this is the case in this toy example).</span>
<span class="va">mean_serial_interval</span> <span class="op">=</span> <span class="fl">4.8</span>
<span class="va">std_serial_interval</span> <span class="op">=</span> <span class="fl">2.3</span>

<span class="co"># The estimation window corresponds to the size of the sliding window used in EpiEstim.</span>
<span class="co"># See help(estimate_Re) for additional details.</span>
<span class="co"># Here, it is set to three days.</span>
<span class="va">estimation_window</span> <span class="op">=</span> <span class="fl">3</span> 

<span class="co">## End of user input</span>

<span class="va">toy_estimates</span> <span class="op">&lt;-</span> <span class="fu">smooth_deconvolve_estimate</span><span class="op">(</span><span class="va">toy_incidence_data</span>,
  smoothing_method <span class="op">=</span> <span class="st">"LOESS"</span>,
  deconvolution_method <span class="op">=</span> <span class="st">"Richardson-Lucy delay distribution"</span>,
  estimation_method <span class="op">=</span> <span class="st">"EpiEstim sliding window"</span>,
  delay_incubation <span class="op">=</span> <span class="va">incubation</span>,
  delay_onset_to_report <span class="op">=</span> <span class="va">onset_to_report</span>,
  estimation_window <span class="op">=</span> <span class="va">estimation_window</span>,
  mean_serial_interval <span class="op">=</span> <span class="va">mean_serial_interval</span>,
  std_serial_interval  <span class="op">=</span> <span class="va">std_serial_interval</span>,
  output_Re_only <span class="op">=</span> <span class="cn">FALSE</span>,
  ref_date <span class="op">=</span> <span class="va">date_first_data_point</span>,
  time_step <span class="op">=</span> <span class="st">"day"</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">toy_estimates</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt;          date observed_incidence smoothed_incidence deconvolved_incidence</span>
<span class="co">#&gt; 1  2020-02-16                 NA                 NA              18.43639</span>
<span class="co">#&gt; 2  2020-02-17                 NA                 NA              21.98931</span>
<span class="co">#&gt; 3  2020-02-18                 NA                 NA              25.78989</span>
<span class="co">#&gt; 4  2020-02-19                 NA                 NA              30.33052</span>
<span class="co">#&gt; 5  2020-02-20                 NA                 NA              36.10101</span>
<span class="co">#&gt; 6  2020-02-21                 NA                 NA              43.46775</span>
<span class="co">#&gt; 7  2020-02-22                 NA                 NA              52.48302</span>
<span class="co">#&gt; 8  2020-02-23                 NA                 NA              63.25173</span>
<span class="co">#&gt; 9  2020-02-24                  4           17.75345              75.80742</span>
<span class="co">#&gt; 10 2020-02-25                  9           21.35431              90.01481</span>
<span class="co">#&gt; 11 2020-02-26                 19           25.29413             105.42458</span>
<span class="co">#&gt; 12 2020-02-27                 14           30.08292             121.78595</span>
<span class="co">#&gt; 13 2020-02-28                 36           36.23071             139.21664</span>
<span class="co">#&gt; 14 2020-02-29                 16           44.08374             157.85615</span>
<span class="co">#&gt; 15 2020-03-01                 39           53.55827             177.84666</span>
<span class="co">#&gt; 16 2020-03-02                 27           64.51933             196.21270</span>
<span class="co">#&gt; 17 2020-03-03                 46           76.83199             210.79070</span>
<span class="co">#&gt; 18 2020-03-04                 77           90.36127             222.97111</span>
<span class="co">#&gt; 19 2020-03-05                 78          104.73262             234.22213</span>
<span class="co">#&gt; 20 2020-03-06                113          119.79569             246.11074</span>
<span class="co">#&gt;      R_mean</span>
<span class="co">#&gt; 1        NA</span>
<span class="co">#&gt; 2        NA</span>
<span class="co">#&gt; 3        NA</span>
<span class="co">#&gt; 4        NA</span>
<span class="co">#&gt; 5  4.454175</span>
<span class="co">#&gt; 6  3.174828</span>
<span class="co">#&gt; 7  2.664187</span>
<span class="co">#&gt; 8  2.443120</span>
<span class="co">#&gt; 9  2.338139</span>
<span class="co">#&gt; 10 2.274462</span>
<span class="co">#&gt; 11 2.215251</span>
<span class="co">#&gt; 12 2.145688</span>
<span class="co">#&gt; 13 2.065824</span>
<span class="co">#&gt; 14 1.983260</span>
<span class="co">#&gt; 15 1.905728</span>
<span class="co">#&gt; 16 1.826669</span>
<span class="co">#&gt; 17 1.735752</span>
<span class="co">#&gt; 18 1.632269</span>
<span class="co">#&gt; 19 1.528623</span>
<span class="co">#&gt; 20 1.440937</span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>JÃ©rÃ©mie Scire <br><small class="roles"> Author, maintainer </small>  </li>
<li>Jana Huisman <br><small class="roles"> Author </small>  </li>
<li>Daniel Angst <br><small class="roles"> Author </small>  </li>
<li>Ana Grosu <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by JÃ©rÃ©mie Scire, Jana Huisman, Daniel Angst, Ana Grosu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
